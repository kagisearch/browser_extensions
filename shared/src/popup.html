<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="popup.css">
  </head>

  <body>
    <div id="content">

      <div class="logo">
        <svg width="80" height="40" viewBox="0 0 105 55" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M81.6028 44.0705H71.5065C68.7746 44.0705 68.2995 41.1325 68.7746 39.9573C69.0122 39.3697 69.6061 38.547 70.0812 37.9594C71.9816 39.0171 74.2385 39.6047 76.614 39.6047C84.2159 39.6047 90.2737 33.4936 90.2737 26.0897C90.2737 22.094 88.492 18.5684 85.7601 15.9829L86.1164 15.6303C86.8291 14.9252 87.8981 14.4551 88.9671 14.5727L90.63 14.6902V8.2265H87.7793C84.4535 8.2265 81.7216 10.2244 80.5338 13.0449C79.346 12.6923 78.0394 12.4573 76.7328 12.4573C69.1309 12.4573 63.0732 18.5684 63.0732 25.9722C63.0732 28.9103 64.0234 31.7308 65.6863 33.9637C65.4488 34.1987 65.0924 34.4338 64.8549 34.5513C64.7361 34.6688 64.6173 34.7863 64.4985 34.9039C61.7666 37.4893 60.46 40.7799 61.1727 44.5406C61.5291 46.5385 63.3107 48.6539 65.0924 49.8291C66.2802 50.6517 67.8244 51.0043 69.3685 51.0043L80.7713 50.5342C82.0779 50.5342 83.2657 51.1218 83.9784 52.297L85.4037 55L92.4117 52.6496L91.2239 50.0641C89.4422 46.4209 85.7601 44.0705 81.6028 44.0705ZM76.7328 19.6261C80.2962 19.6261 83.2657 22.5641 83.2657 26.0897C83.2657 29.6154 80.2962 32.5534 76.7328 32.5534C73.1694 32.5534 70.2 29.6154 70.2 26.0897C70.2 22.4466 73.0507 19.6261 76.7328 19.6261Z" fill="currentColor"></path>
          <path d="M41.8124 12.3398C34.6856 12.6923 28.7466 18.3334 28.2715 25.3846C27.6776 33.7286 34.3293 40.6624 42.525 40.6624C45.257 40.6624 47.7513 39.1346 49.8894 37.8419V40.3098H56.8974V25.9722C56.541 18.0983 49.8894 11.9872 41.8124 12.3398ZM42.525 34.0812C38.249 34.0812 34.9232 30.6731 34.9232 26.5598C34.9232 22.3291 38.3678 19.0385 42.525 19.0385C46.8011 19.0385 50.1269 22.4466 50.1269 26.5598C50.2457 30.6731 46.8011 34.0812 42.525 34.0812Z" fill="currentColor"></path>
          <path d="M28.3883 12.8098H18.5296L9.97747 21.2714L7.00799 24.2094V7.99145H0V40.3098H7.00799V28.2051L9.97747 31.1432V31.0256L19.2423 40.3098H29.101L14.016 26.2073L28.3883 12.8098Z" fill="currentColor"></path>
          <path d="M97.0414 37.8418V40.1923H104.049V12.8098H97.0414V37.8418Z" fill="currentColor"></path>
          <path d="M100.486 8.93162C102.979 8.93162 105 6.93221 105 4.46581C105 1.99941 102.979 0 100.486 0C97.9936 0 95.9728 1.99941 95.9728 4.46581C95.9728 6.93221 97.9936 8.93162 100.486 8.93162Z" fill="currentColor"></path>
          </svg>
      </div>

      <div id="header">
        <h3>Search Extension</h3>

        <p id="status" class="status_error">
          <span id="no_session">
            No kagi session found.
            Login to Kagi or open a Kagi tab and the extension will automatically configure
            <br>
            <a href="https://kagi.com" target="_blank">Let's go!</a>
          </span>
          <span id="manual_token" style="display: none">
            Using manual login token, the extension is ready to use!
          </span>
          <span id="auto_token" style="display: none">
            Found a Kagi session, the extension is ready to use!
          </span>
        </p>

        <span id="advanced">Advanced settings</a>
      </div>

      <div id="token" style="display: none">

        <div id="incognito" style="display: none">
          <span>
            If you want to use Kagi automatically in incognito mode, you need to enable incognito mode in the extension settings.
          </span>
          <br>
          <div id="firefox_ext" style="display: none">
            <ol>
              <li>Go to <b>about:addons</b></li>
              <li>find the Kagi extension and click the 3 dots (...) on the right side</li>
              <li>Click "Manage"</li>
              <li>check the "Allow" box next to "Run in Private Windows"</li>
            </ol>
          </div>
          <div id="chrome_ext" style="display: none">
            <ol>
              <li> Go to <a id="chrome_link" href="#">the extension settings</a></li>
              <li>Check the "Allow in incognito" toggle</li>
            </ol>
          </div>
        </div>

        <div class="setting_row">
          <div>
            <div class="title">
              Set your login token to use in private browsing tabs
            </div>
            <div class="desc">
              You can paste the login url from the control center or the raw login token.
              <br />
              <a href="https://kagi.com/faq#using-login-token" target="_blank">Learn more about login tokens</a>
            </div>
          </div>
        </div>

        <div class="setting_row">
          <input type="password" id="token_input" value="" placeholder="my token"/>
        </div>

        <div class="setting_row">
          <div>
            <div class="title">
              Universal Summarizer API key
            </div>
            <div class="desc">
              This enables selection of advanced summarization models available with the <a href="https://kagi.com/summarizer/api.html" target="_blank">Universal Summarizer API</a>.
              <br />
              Note: You can still use summarize feature in Kagi extension without any API key, provided you are logged in into your Kagi account.
            </div>
          </div>
        </div>

        <div class="setting_row">
          <input type="password" id="api_token_input" value="" placeholder="my API key"/>
        </div>

        <div class="setting_row api_param" style="display: none">
          <div>
            <label class="title" for="engine">API Summarizer Engine</label>
            <select id="engine">
              <option value="cecil" selected="selected">Cecil</option>
              <option value="agnes">Agnes</option>
              <option value="daphne">Daphne</option>
              <option value="muriel">Muriel</option>
            </select>
          </div>
        </div>

        <div class="setting_row">
          <button id="token_save">Save settings</button>
        </div>

      </div>

      <div id="summarize">

        <div class="title">
          Summarize the current page
        </div>

        <div class="setting_row">
          <div>
            <label for="summary_type">Summary Type</label>
            <select id="summary_type">
              <option value="summary" selected="selected">Summary</option>
              <option value="takeaway">Key Moments</option>
            </select>
          </div>

          <div>
            <label for="target_language">Output Language</label>
            <select id="target_language">
              <option value="" selected="selected">Default</option>
              <option value="BG">Bulgarian</option>
              <option value="CS">Czech</option>
              <option value="DA">Danish</option>
              <option value="DE">German</option>
              <option value="EL">Greek</option>
              <option value="EN">English</option>
              <option value="ES">Spanish</option>
              <option value="ET">Estonian</option>
              <option value="FI">Finnish</option>
              <option value="FR">French</option>
              <option value="HU">Hungarian</option>
              <option value="ID">Indonesian</option>
              <option value="IT">Italian</option>
              <option value="JA">Japanese</option>
              <option value="KO">Korean</option>
              <option value="LT">Lithuanian</option>
              <option value="LV">Latvian</option>
              <option value="NB">Norwegian</option>
              <option value="NL">Dutch</option>
              <option value="PL">Polish</option>
              <option value="PT">Portuguese</option>
              <option value="RO">Romanian</option>
              <option value="RU">Russian</option>
              <option value="SK">Slovak</option>
              <option value="SL">Slovenian</option>
              <option value="SV">Swedish</option>
              <option value="TR">Turkish</option>
              <option value="UK">Ukrainian</option>
              <option value="ZH">Chinese (simplified)</option>
            </select>
          </div>

          <button id="summarize_page">Summarize</button>
        </div>

        <div id="summary_result" class="result" style="display: none">
          ...
        </div>

        <button id="copy_summary" style="display: none">Copy summary</button>
      </div>
    </div>
    <script type="module" src="popup.js"></script>
  </body>
</html>
